{"ast":null,"code":"var _jsxFileName = \"/Users/jake/workspace/token-builder/src/Components/DashboardCard.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { ethers } from 'ethers';\nimport Card from 'react-bootstrap/Card';\nimport TokenEntry from './TokenEntry';\nimport Dashboard from './Dashboard';\nimport abi from './abi';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst DashboardCard = props => {\n  _s();\n\n  const [tokenData, setTokenData] = useState({});\n  useEffect(async () => {\n    if (props.tokenAddress !== '') {\n      handleSubmit(props.tokenAddress);\n    }\n\n    const provider = new ethers.providers.Web3Provider(window.ethereum, \"any\");\n    await provider.send(\"eth_requestAccounts\", []);\n    const signer = provider.getSigner();\n    const erc20 = new ethers.Contract(addr, abi, signer);\n    const filter = erc20.filters.Transfer(signer.address);\n    erc20.on(filter, async (from, to, amount, event) => {\n      console.log(JSON.stringify(tokenData));\n      const bal = await erc20.balanceOf(signer.address);\n      setTokenData({ ...tokenData,\n        balance: bal.toString()\n      });\n      console.log(JSON.stringify(tokenData));\n    });\n    provider.provider.on(\"accountsChanged\", async () => {\n      const signer = provider.getSigner();\n      const erc20 = new ethers.Contract(props.tokenAddress, abi, signer);\n      const pUser = signer.getAddress();\n      const pName = erc20.name();\n      const pSymbol = erc20.symbol();\n      const pDecimals = erc20.decimals();\n      const [user, name, symbol, decimals] = await Promise.all([pUser, pName, pSymbol, pDecimals]);\n      const balance = await erc20.balanceOf(user);\n      setTokenData({\n        accountAddress: user,\n        balance: balance.toString(),\n        name: name,\n        symbol: symbol,\n        decimals: decimals\n      });\n    });\n    return () => {\n      erc20.removeAllListeners();\n    };\n  }, []);\n\n  const handleSubmit = async addr => {\n    try {\n      const provider = new ethers.providers.Web3Provider(window.ethereum, \"any\");\n      await provider.send(\"eth_requestAccounts\", []);\n      const signer = provider.getSigner();\n      const erc20 = new ethers.Contract(addr, abi, signer);\n      const pUser = signer.getAddress();\n      const pName = erc20.name();\n      const pSymbol = erc20.symbol();\n      const pDecimals = erc20.decimals();\n      const [user, name, symbol, decimals] = await Promise.all([pUser, pName, pSymbol, pDecimals]);\n      const balance = await erc20.balanceOf(user);\n      setTokenData({\n        accountAddress: user,\n        balance: balance.toString(),\n        name: name,\n        symbol: symbol,\n        decimals: decimals\n      });\n      props.setTokenAddress(addr);\n    } catch (e) {\n      console.error(e);\n      alert('Error: Token address invalid.');\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(Card, {\n    children: props.tokenAddress === '' ? /*#__PURE__*/_jsxDEV(TokenEntry, {\n      submit: handleSubmit\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 42\n    }, this) : /*#__PURE__*/_jsxDEV(Dashboard, {\n      tokenAddress: props.tokenAddress,\n      tokenData: tokenData,\n      reset: props.reset\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 80\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 9\n  }, this);\n};\n\n_s(DashboardCard, \"J0xnJA/Rb0dxidIcu9s9opsqx5U=\");\n\n_c = DashboardCard;\nexport default DashboardCard;\n\nvar _c;\n\n$RefreshReg$(_c, \"DashboardCard\");","map":{"version":3,"sources":["/Users/jake/workspace/token-builder/src/Components/DashboardCard.js"],"names":["React","useState","useEffect","ethers","Card","TokenEntry","Dashboard","abi","DashboardCard","props","tokenData","setTokenData","tokenAddress","handleSubmit","provider","providers","Web3Provider","window","ethereum","send","signer","getSigner","erc20","Contract","addr","filter","filters","Transfer","address","on","from","to","amount","event","console","log","JSON","stringify","bal","balanceOf","balance","toString","pUser","getAddress","pName","name","pSymbol","symbol","pDecimals","decimals","user","Promise","all","accountAddress","removeAllListeners","setTokenAddress","e","error","alert","reset"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { ethers } from 'ethers';\nimport Card from 'react-bootstrap/Card';\nimport TokenEntry from './TokenEntry';\nimport Dashboard from './Dashboard'\nimport abi from './abi'\n\nconst DashboardCard = (props) => {\n    const [tokenData, setTokenData] = useState({});\n\n    useEffect(async () => {\n        if (props.tokenAddress!=='') {\n            handleSubmit(props.tokenAddress);\n        }\n        const provider = new ethers.providers.Web3Provider(window.ethereum, \"any\");\n        await provider.send(\"eth_requestAccounts\", []);\n        const signer = provider.getSigner();\n        const erc20 = new ethers.Contract(addr, abi, signer);\n        const filter = erc20.filters.Transfer(signer.address);\n        erc20.on(filter, async (from, to, amount, event) => {\n            console.log(JSON.stringify(tokenData))\n            const bal = await erc20.balanceOf(signer.address);\n            setTokenData({...tokenData, balance: bal.toString()});\n            console.log(JSON.stringify(tokenData))\n        });\n        provider.provider.on(\"accountsChanged\", async () => {\n            const signer = provider.getSigner();\n            const erc20 = new ethers.Contract(props.tokenAddress, abi, signer);\n            const pUser = signer.getAddress();\n            const pName = erc20.name();\n            const pSymbol = erc20.symbol();\n            const pDecimals = erc20.decimals();\n            const [user, name, symbol, decimals] = await Promise.all([pUser, pName, pSymbol, pDecimals]);\n            const balance = await erc20.balanceOf(user);\n            setTokenData({\n                accountAddress: user,\n                balance: balance.toString(),\n                name: name,\n                symbol: symbol,\n                decimals: decimals\n            });\n        });\n        return (()=>{\n            erc20.removeAllListeners();\n        });\n    }, []);\n\n    const handleSubmit = async (addr) => {\n        try {\n            const provider = new ethers.providers.Web3Provider(window.ethereum, \"any\");\n            await provider.send(\"eth_requestAccounts\", []);\n            const signer = provider.getSigner();\n            const erc20 = new ethers.Contract(addr, abi, signer);\n            const pUser = signer.getAddress();\n            const pName = erc20.name();\n            const pSymbol = erc20.symbol();\n            const pDecimals = erc20.decimals();\n            const [user, name, symbol, decimals] = await Promise.all([pUser, pName, pSymbol, pDecimals]);\n            const balance = await erc20.balanceOf(user);\n            setTokenData({\n                accountAddress: user,\n                balance: balance.toString(),\n                name: name,\n                symbol: symbol,\n                decimals: decimals\n            });\n            props.setTokenAddress(addr);\n        } catch (e) { \n            console.error(e);\n            alert('Error: Token address invalid.');\n        }\n    }\n\n    return (\n        <Card>\n            {(props.tokenAddress==='') ? <TokenEntry submit={handleSubmit}/> : <Dashboard tokenAddress={props.tokenAddress} tokenData={tokenData} reset={props.reset}/>}\n        </Card>\n    )\n}\n\nexport default DashboardCard"]},"metadata":{},"sourceType":"module"}