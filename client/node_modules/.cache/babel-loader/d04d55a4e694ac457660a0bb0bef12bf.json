{"ast":null,"code":"var _jsxFileName = \"/Users/jake/workspace/token-builder/src/Components/DashboardCard.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { ethers } from 'ethers';\nimport Card from 'react-bootstrap/Card';\nimport TokenEntry from './TokenEntry';\nimport Dashboard from './Dashboard';\nimport abi from './abi';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst provider = new ethers.providers.Web3Provider(window.ethereum, \"any\");\n\nconst DashboardCard = props => {\n  _s();\n\n  const [tokenData, setTokenData] = useState({\n    accountAddress: '',\n    balance: '',\n    name: '',\n    symbol: '',\n    decimals: ''\n  });\n  useEffect(async () => {\n    const addr = await props.web3.signer.getAddress();\n    const filter = props.web3.contract.filters.Transfer(addr);\n    props.web3.contract.on(filter, async (from, to, amount, event) => {\n      const bal = await props.web3.contract.balanceOf(addr);\n      setTokenData({ ...tokenData,\n        balance: bal.toString()\n      });\n    });\n    return () => {\n      props.web3.contract.removeAllListeners();\n    };\n  }, []);\n\n  const handleSubmit = async addr => {\n    try {\n      const erc20 = new ethers.Contract(addr, abi, props.web3.signer);\n      const pUser = props.web3.signer.getAddress();\n      const pName = erc20.name();\n      const pSymbol = erc20.symbol();\n      const pDecimals = erc20.decimals();\n      const [user, name, symbol, decimals] = await Promise.all([pUser, pName, pSymbol, pDecimals]);\n      const balance = await erc20.balanceOf(user);\n      props.updateContract(erc20);\n      setTokenData({\n        accountAddress: user,\n        balance: balance.toString(),\n        name: name,\n        symbol: symbol,\n        decimals: decimals\n      });\n      props.setTokenAddress(addr);\n    } catch (e) {\n      console.error(e);\n      alert('Error: Token address invalid.');\n    }\n  };\n\n  const updateTokenData = data => {\n    setTokenData(data);\n    console.log(data);\n  };\n\n  return /*#__PURE__*/_jsxDEV(Card, {\n    children: props.tokenAddress === '' ? /*#__PURE__*/_jsxDEV(TokenEntry, {\n      submit: handleSubmit\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 42\n    }, this) : /*#__PURE__*/_jsxDEV(Dashboard, {\n      tokenAddress: props.tokenAddress,\n      tokenData: tokenData,\n      updateTokenData: updateTokenData,\n      reset: props.reset\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 80\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 61,\n    columnNumber: 9\n  }, this);\n};\n\n_s(DashboardCard, \"7fURo3sgTaDCxfKwNzYII0Zx99Q=\");\n\n_c = DashboardCard;\nexport default DashboardCard;\n\nvar _c;\n\n$RefreshReg$(_c, \"DashboardCard\");","map":{"version":3,"sources":["/Users/jake/workspace/token-builder/src/Components/DashboardCard.js"],"names":["React","useState","useEffect","ethers","Card","TokenEntry","Dashboard","abi","provider","providers","Web3Provider","window","ethereum","DashboardCard","props","tokenData","setTokenData","accountAddress","balance","name","symbol","decimals","addr","web3","signer","getAddress","filter","contract","filters","Transfer","on","from","to","amount","event","bal","balanceOf","toString","removeAllListeners","handleSubmit","erc20","Contract","pUser","pName","pSymbol","pDecimals","user","Promise","all","updateContract","setTokenAddress","e","console","error","alert","updateTokenData","data","log","tokenAddress","reset"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { ethers } from 'ethers';\nimport Card from 'react-bootstrap/Card';\nimport TokenEntry from './TokenEntry';\nimport Dashboard from './Dashboard'\nimport abi from './abi'\n\nconst provider = new ethers.providers.Web3Provider(window.ethereum, \"any\");\n\nconst DashboardCard = (props) => {\n    const [tokenData, setTokenData] = useState({\n        accountAddress: '',\n        balance: '',\n        name: '',\n        symbol: '',\n        decimals: ''\n    });\n\n    useEffect(async () => {\n        const addr = await props.web3.signer.getAddress();\n        const filter = props.web3.contract.filters.Transfer(addr);\n        props.web3.contract.on(filter, async (from, to, amount, event) => {\n            const bal = await props.web3.contract.balanceOf(addr);\n            setTokenData({...tokenData, balance: bal.toString()});\n        });\n        return (()=>{\n            props.web3.contract.removeAllListeners();\n        });\n    }, []);\n\n    const handleSubmit = async (addr) => {\n        try {\n            const erc20 = new ethers.Contract(addr, abi, props.web3.signer);\n            const pUser = props.web3.signer.getAddress();\n            const pName = erc20.name();\n            const pSymbol = erc20.symbol();\n            const pDecimals = erc20.decimals();\n            const [user, name, symbol, decimals] = await Promise.all([pUser, pName, pSymbol, pDecimals]);\n            const balance = await erc20.balanceOf(user);\n            props.updateContract(erc20);\n            setTokenData({\n                accountAddress: user,\n                balance: balance.toString(),\n                name: name,\n                symbol: symbol,\n                decimals: decimals\n            });\n            props.setTokenAddress(addr);\n        } catch (e) { \n            console.error(e);\n            alert('Error: Token address invalid.');\n        }\n    }\n\n    const updateTokenData = (data) => {\n        setTokenData(data);\n        console.log(data)\n    }\n\n    return (\n        <Card>\n            {(props.tokenAddress==='') ? <TokenEntry submit={handleSubmit}/> : <Dashboard tokenAddress={props.tokenAddress} tokenData={tokenData} updateTokenData={updateTokenData} reset={props.reset}/>}\n        </Card>\n    )\n}\n\nexport default DashboardCard"]},"metadata":{},"sourceType":"module"}