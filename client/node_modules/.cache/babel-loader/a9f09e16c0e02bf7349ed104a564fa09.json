{"ast":null,"code":"import _objectSpread from\"/Users/jake/workspace/token-builder/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/jake/workspace/token-builder/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/jake/workspace/token-builder/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/jake/workspace/token-builder/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState,useEffect}from'react';import{ethers}from'ethers';import'./dashboard.css';import{Link}from'react-router-dom';import Form from'react-bootstrap/Form';import Button from'react-bootstrap/Button';import abi from'./abi';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var rxAddress=/^0x[a-fA-F0-9]{40}$/;var Dashboard=function Dashboard(props){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),transferRecipient=_useState2[0],setTransferRecipient=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),transferAmount=_useState4[0],setTransferAmount=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),allowanceSpender=_useState6[0],setAllowanceSpender=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),allowanceAmount=_useState8[0],setAllowanceAmount=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),allowanceAvailable=_useState10[0],setAllowanceAvailable=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),validAllowance=_useState12[0],setValidAllowance=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),claimOwner=_useState14[0],setClaimOwner=_useState14[1];var _useState15=useState(''),_useState16=_slicedToArray(_useState15,2),claimAmount=_useState16[0],setClaimAmount=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),sendAllowance=_useState18[0],setSendAllowance=_useState18[1];var _useState19=useState(''),_useState20=_slicedToArray(_useState19,2),sendAddress=_useState20[0],setSendAddress=_useState20[1];useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var decimals,_allowance;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!rxAddress.test(claimOwner)){_context.next=22;break;}_context.next=3;return props.web3.contract.decimals();case 3:decimals=_context.sent;_context.prev=4;_context.t0=props.web3.contract;_context.t1=claimOwner;_context.next=9;return props.web3.signer.getAddress();case 9:_context.t2=_context.sent;_context.next=12;return _context.t0.allowance.call(_context.t0,_context.t1,_context.t2);case 12:_allowance=_context.sent;setAllowanceAvailable(formatBalance(_allowance.toString(),decimals));setValidAllowance(true);_context.next=20;break;case 17:_context.prev=17;_context.t3=_context[\"catch\"](4);console.error(_context.t3);case 20:_context.next=23;break;case 22:setValidAllowance(false);case 23:case\"end\":return _context.stop();}}},_callee,null,[[4,17]]);})),[claimOwner]);useEffect(function(){props.web3.contract.removeAllListeners();return function(){props.web3.contract.removeAllListeners();};},[]);useEffect(function(){var run=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var dec,_allowance,filter,filter2,filter3;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(!props.tokenData.accountAddress){_context5.next=15;break;}if(!rxAddress.test(claimOwner)){_context5.next=9;break;}_context5.next=4;return props.web3.contract.decimals();case 4:dec=_context5.sent;_context5.next=7;return props.web3.contract.allowance(claimOwner,props.tokenData.accountAddress);case 7:_allowance=_context5.sent;setAllowanceAvailable(formatBalance(_allowance.toString(),dec));case 9:// transfer()\nfilter=props.web3.contract.filters.Transfer(props.tokenData.accountAddress);props.web3.contract.on(filter,/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(from,to,amount,event){var bal;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return props.web3.contract.balanceOf(props.tokenData.accountAddress);case 2:bal=_context2.sent;props.updateTokenData(_objectSpread(_objectSpread({},props.tokenData),{},{balance:bal.toString()}));case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x,_x2,_x3,_x4){return _ref3.apply(this,arguments);};}());// transferFrom()\nfilter2=props.web3.contract.filters.Transfer(null,props.tokenData.accountAddress);props.web3.contract.on(filter2,/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(from,to,amount,event){var bal,dec,_allowance;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return props.web3.contract.balanceOf(props.tokenData.accountAddress);case 2:bal=_context3.sent;_context3.next=5;return props.web3.contract.decimals();case 5:dec=_context3.sent;props.updateTokenData(_objectSpread(_objectSpread({},props.tokenData),{},{balance:bal.toString()}));_context3.next=9;return props.web3.contract.allowance(from,to);case 9:_allowance=_context3.sent;setAllowanceAvailable(formatBalance(_allowance.toString(),dec));case 11:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x5,_x6,_x7,_x8){return _ref4.apply(this,arguments);};}());// approve()\nfilter3=props.web3.contract.filters.Approval(null,props.tokenData.accountAddress);props.web3.contract.on(filter3,/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(from,to,amount,event){var _dec,_allowance2;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(!(from===claimOwner)){_context4.next=8;break;}_context4.next=3;return props.web3.contract.decimals();case 3:_dec=_context4.sent;_context4.next=6;return props.web3.contract.allowance(from,to);case 6:_allowance2=_context4.sent;setAllowanceAvailable(formatBalance(_allowance2.toString(),_dec));case 8:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x9,_x10,_x11,_x12){return _ref5.apply(this,arguments);};}());case 15:case\"end\":return _context5.stop();}}},_callee5);}));return function run(){return _ref2.apply(this,arguments);};}();run();return function(){props.web3.contract.removeAllListeners();};},[props.tokenData.accountAddress]);useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(){var erc20,pUser,pName,pSymbol,pDecimals,_yield$Promise$all,_yield$Promise$all2,user,name,symbol,decimals,balance;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:erc20=new ethers.Contract(props.tokenAddress,abi,props.web3.signer);pUser=props.web3.signer.getAddress();pName=erc20.name();pSymbol=erc20.symbol();pDecimals=erc20.decimals();_context7.next=7;return Promise.all([pUser,pName,pSymbol,pDecimals]);case 7:_yield$Promise$all=_context7.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,4);user=_yield$Promise$all2[0];name=_yield$Promise$all2[1];symbol=_yield$Promise$all2[2];decimals=_yield$Promise$all2[3];_context7.next=15;return erc20.balanceOf(user);case 15:balance=_context7.sent;props.updateTokenData({accountAddress:user,balance:balance.toString(),name:name,symbol:symbol,decimals:decimals});props.web3.provider.provider.on(\"accountsChanged\",/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var signer,pUser,pName,pSymbol,pDecimals,_yield$Promise$all3,_yield$Promise$all4,user,name,symbol,decimals,balance;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:signer=props.web3.provider.getSigner();pUser=signer.getAddress();pName=props.web3.contract.name();pSymbol=props.web3.contract.symbol();pDecimals=props.web3.contract.decimals();_context6.next=7;return Promise.all([pUser,pName,pSymbol,pDecimals]);case 7:_yield$Promise$all3=_context6.sent;_yield$Promise$all4=_slicedToArray(_yield$Promise$all3,4);user=_yield$Promise$all4[0];name=_yield$Promise$all4[1];symbol=_yield$Promise$all4[2];decimals=_yield$Promise$all4[3];_context6.next=15;return props.web3.contract.balanceOf(user);case 15:balance=_context6.sent;props.updateTokenData({accountAddress:user,balance:balance.toString(),name:name,symbol:symbol,decimals:decimals});case 17:case\"end\":return _context6.stop();}}},_callee6);})));case 18:case\"end\":return _context7.stop();}}},_callee7);})),[]);var transferTokens=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(recipient,amount){var decimals;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.prev=0;_context8.next=3;return props.web3.contract.decimals();case 3:decimals=_context8.sent;_context8.next=6;return props.web3.contract.transfer(recipient,parseAmount(amount,decimals));case 6:_context8.next=12;break;case 8:_context8.prev=8;_context8.t0=_context8[\"catch\"](0);console.error(_context8.t0);alert('Error: Transfer failed.');case 12:case\"end\":return _context8.stop();}}},_callee8,null,[[0,8]]);}));return function transferTokens(_x13,_x14){return _ref8.apply(this,arguments);};}();var setTokenAllowance=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(recipient,amount){var sender,balance,decimals;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.prev=0;_context9.next=3;return props.web3.signer.getAddress();case 3:sender=_context9.sent;_context9.next=6;return props.web3.contract.balanceOf(sender);case 6:balance=_context9.sent;_context9.next=9;return props.web3.contract.decimals();case 9:decimals=_context9.sent;if(!(balance>=formatBalance(amount,decimals))){_context9.next=15;break;}_context9.next=13;return props.web3.contract.approve(recipient,parseAmount(amount,decimals));case 13:_context9.next=16;break;case 15:alert(\"Error: Insufficient balance.\");case 16:_context9.next=22;break;case 18:_context9.prev=18;_context9.t0=_context9[\"catch\"](0);console.error(_context9.t0);alert('Error: Allowance failed.');case 22:case\"end\":return _context9.stop();}}},_callee9,null,[[0,18]]);}));return function setTokenAllowance(_x15,_x16){return _ref9.apply(this,arguments);};}();var transferAllowance=/*#__PURE__*/function(){var _ref10=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(owner,recipient,amount){var balance,decimals;return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_context10.prev=0;_context10.next=3;return props.web3.contract.balanceOf(owner);case 3:balance=_context10.sent;_context10.next=6;return props.web3.contract.decimals();case 6:decimals=_context10.sent;if(!(balance>=formatBalance(amount,decimals))){_context10.next=10;break;}_context10.next=10;return props.web3.contract.transferFrom(owner,recipient,parseAmount(amount,decimals));case 10:_context10.next=16;break;case 12:_context10.prev=12;_context10.t0=_context10[\"catch\"](0);console.error(_context10.t0);alert('Error: Transfer failed.');case 16:case\"end\":return _context10.stop();}}},_callee10,null,[[0,12]]);}));return function transferAllowance(_x17,_x18,_x19){return _ref10.apply(this,arguments);};}();var formatBalance=function formatBalance(balance,dec){if(dec===0)return balance;var bal=balance;while(bal.length<=dec){bal='0'+bal;}bal=bal.slice(0,0-dec)+'.'+bal.slice(0-dec);while(bal[bal.length-1]==='0'){bal=bal.slice(0,-1);}if(bal[bal.length-1]==='.')bal=bal.slice(0,-1);return bal;};var parseAmount=function parseAmount(amt,dec){var amount=amt;if(amount.indexOf('.')<0){for(var i=0;i<dec;i++){amount=amount+'0';}return amount;}while(amount.length-amount.indexOf('.')<=dec){amount=amount+'0';}if(amount.length-amount.indexOf('.')>dec+1)amount=amount.slice(0,amount.indexOf('.')+dec);return amount.slice(0,amount.indexOf('.'))+amount.slice(amount.indexOf('.')+1);};return/*#__PURE__*/_jsxs(Form,{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Token Dashboard\"}),/*#__PURE__*/_jsx(\"div\",{className:\"form-row\",children:/*#__PURE__*/_jsxs(\"label\",{children:[\"Token Address: \",props.tokenAddress]})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-row\",children:/*#__PURE__*/_jsxs(\"label\",{children:[\"Token Name: \",props.tokenData.name]})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-row\",children:/*#__PURE__*/_jsxs(\"label\",{children:[\"Token Symbol: \",props.tokenData.symbol]})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-row\",children:/*#__PURE__*/_jsxs(\"label\",{children:[\"Account Address: \",props.tokenData.accountAddress]})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-row\",children:/*#__PURE__*/_jsxs(\"label\",{children:[\"Token Balance: \",formatBalance(props.tokenData.balance.toString(),props.tokenData.decimals),\" \",props.tokenData.symbol]})}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"h3\",{children:\"Transfer Tokens\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Recipient\"}),/*#__PURE__*/_jsx(\"input\",{className:\"text-input\",value:transferRecipient,onChange:function onChange(event){return setTransferRecipient(event.target.value);}}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"label\",{children:\"Amount\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:transferAmount,onChange:function onChange(event){return setTransferAmount(event.target.value);}}),/*#__PURE__*/_jsx(Button,{size:\"sm\",variant:\"danger\",onClick:function onClick(){return transferTokens(transferRecipient,transferAmount);},children:\"Transfer\"})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"h3\",{children:\"Set Token Allowance\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Spender\"}),/*#__PURE__*/_jsx(\"input\",{className:\"text-input\",value:allowanceSpender,onChange:function onChange(event){return setAllowanceSpender(event.target.value);}}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"label\",{children:\"Amount\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:allowanceAmount,onChange:function onChange(event){return setAllowanceAmount(event.target.value);}}),/*#__PURE__*/_jsx(Button,{size:\"sm\",variant:\"danger\",onClick:function onClick(){return setTokenAllowance(allowanceSpender,allowanceAmount);},children:\"Set Allowance\"})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"h3\",{children:\"Claim Allowance\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Owner\"}),/*#__PURE__*/_jsx(\"input\",{className:\"text-input\",value:claimOwner,onChange:function onChange(event){return setClaimOwner(event.target.value);}}),/*#__PURE__*/_jsx(\"br\",{}),validAllowance&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"Available Allowance: \",allowanceAvailable,\" \",props.tokenData.symbol]}),/*#__PURE__*/_jsx(\"br\",{})]}),/*#__PURE__*/_jsx(\"label\",{children:\"Amount\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:claimAmount,onChange:function onChange(event){return setClaimAmount(event.target.value);}}),/*#__PURE__*/_jsx(Button,{size:\"sm\",variant:\"danger\",onClick:function onClick(){return transferAllowance(claimOwner,sendAllowance?sendAddress:props.tokenData.accountAddress,claimAmount);},children:sendAllowance?\"Send Allowance\":\"Claim Allowance\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form-row btn-row\",children:/*#__PURE__*/_jsx(Link,{to:\"/token-builder/dashboard\",children:/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:props.reset,children:\"Use a Different Token\"})})})]});};export default Dashboard;","map":{"version":3,"sources":["/Users/jake/workspace/token-builder/src/Components/Dashboard.jsx"],"names":["React","useState","useEffect","ethers","Link","Form","Button","abi","rxAddress","Dashboard","props","transferRecipient","setTransferRecipient","transferAmount","setTransferAmount","allowanceSpender","setAllowanceSpender","allowanceAmount","setAllowanceAmount","allowanceAvailable","setAllowanceAvailable","validAllowance","setValidAllowance","claimOwner","setClaimOwner","claimAmount","setClaimAmount","sendAllowance","setSendAllowance","sendAddress","setSendAddress","test","web3","contract","decimals","signer","getAddress","allowance","_allowance","formatBalance","toString","console","error","removeAllListeners","run","tokenData","accountAddress","dec","filter","filters","Transfer","on","from","to","amount","event","balanceOf","bal","updateTokenData","balance","filter2","filter3","Approval","erc20","Contract","tokenAddress","pUser","pName","name","pSymbol","symbol","pDecimals","Promise","all","user","provider","getSigner","transferTokens","recipient","transfer","parseAmount","alert","setTokenAllowance","sender","approve","transferAllowance","owner","transferFrom","length","slice","amt","indexOf","i","target","value","reset"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { ethers } from 'ethers'\nimport './dashboard.css';\nimport { Link } from 'react-router-dom';\nimport Form from 'react-bootstrap/Form';\nimport Button from 'react-bootstrap/Button'\nimport abi from './abi'\n\nconst rxAddress = /^0x[a-fA-F0-9]{40}$/;\n\nconst Dashboard = (props) => {\n    const [transferRecipient, setTransferRecipient] = useState('');\n    const [transferAmount, setTransferAmount] = useState('');\n\n    const [allowanceSpender, setAllowanceSpender] = useState('');\n    const [allowanceAmount, setAllowanceAmount] = useState('');\n\n    const [allowanceAvailable, setAllowanceAvailable] = useState('');\n    const [validAllowance, setValidAllowance] = useState(false);\n\n    const [claimOwner, setClaimOwner] = useState('');\n    const [claimAmount, setClaimAmount] = useState('');\n    const [sendAllowance, setSendAllowance] = useState(false);\n    const [sendAddress, setSendAddress] = useState('');\n\n    useEffect(async () => {\n        if (rxAddress.test(claimOwner)) {\n            const decimals = await props.web3.contract.decimals();\n            try {\n                const _allowance = await props.web3.contract.allowance(claimOwner, await props.web3.signer.getAddress());\n                setAllowanceAvailable(formatBalance(_allowance.toString(), decimals));\n                setValidAllowance(true);\n            } catch(err) {\n                console.error(err);\n            }\n        }\n        else setValidAllowance(false);\n    }, [claimOwner]);\n\n    useEffect(() => {\n        props.web3.contract.removeAllListeners();\n        return (()=>{\n            props.web3.contract.removeAllListeners();\n        });\n    }, []);\n\n    useEffect(() => {\n        const run = async () => {\n            if (props.tokenData.accountAddress) {\n                //Change allowance display if visible\n                if (rxAddress.test(claimOwner)) {\n                    const dec = await props.web3.contract.decimals();\n                    const _allowance = await props.web3.contract.allowance(claimOwner, props.tokenData.accountAddress);\n                    setAllowanceAvailable(formatBalance(_allowance.toString(), dec));\n                }\n                // transfer()\n                const filter = props.web3.contract.filters.Transfer(props.tokenData.accountAddress);\n                props.web3.contract.on(filter, async (from, to, amount, event) => {\n                    const bal = await props.web3.contract.balanceOf(props.tokenData.accountAddress);\n                    props.updateTokenData({...props.tokenData, balance: bal.toString()});\n                });\n                // transferFrom()\n                const filter2 = props.web3.contract.filters.Transfer(null, props.tokenData.accountAddress);\n                props.web3.contract.on(filter2, async (from, to, amount, event) => {\n                    const bal = await props.web3.contract.balanceOf(props.tokenData.accountAddress);\n                    const dec = await props.web3.contract.decimals();\n                    props.updateTokenData({...props.tokenData, balance: bal.toString()});\n                    const _allowance = await props.web3.contract.allowance(from, to);\n                    setAllowanceAvailable(formatBalance(_allowance.toString(), dec));\n                });\n                // approve()\n                const filter3 = props.web3.contract.filters.Approval(null, props.tokenData.accountAddress);\n                props.web3.contract.on(filter3, async (from, to, amount, event) => {\n                    //TODO: run only if approving address == claimOwner\n                    if (from === claimOwner) {\n                        const dec = await props.web3.contract.decimals();\n                        const _allowance = await props.web3.contract.allowance(from, to);\n                        setAllowanceAvailable(formatBalance(_allowance.toString(), dec));\n                    }\n                });\n            }\n        }\n        run();\n        return (()=>{\n            props.web3.contract.removeAllListeners();\n        });\n    }, [props.tokenData.accountAddress]);\n\n    useEffect(async () => {\n        const erc20 = new ethers.Contract(props.tokenAddress, abi, props.web3.signer)\n        const pUser = props.web3.signer.getAddress();\n        const pName = erc20.name();\n        const pSymbol = erc20.symbol();\n        const pDecimals = erc20.decimals();\n        const [user, name, symbol, decimals] = await Promise.all([pUser, pName, pSymbol, pDecimals]);\n        const balance = await erc20.balanceOf(user);\n        props.updateTokenData({\n            accountAddress: user,\n            balance: balance.toString(),\n            name: name,\n            symbol: symbol,\n            decimals: decimals\n        });\n        props.web3.provider.provider.on(\"accountsChanged\", async () => {\n            const signer = props.web3.provider.getSigner();\n            const pUser = signer.getAddress();\n            const pName = props.web3.contract.name();\n            const pSymbol = props.web3.contract.symbol();\n            const pDecimals = props.web3.contract.decimals();\n            const [user, name, symbol, decimals] = await Promise.all([pUser, pName, pSymbol, pDecimals]);\n            const balance = await props.web3.contract.balanceOf(user);\n            props.updateTokenData({\n                accountAddress: user,\n                balance: balance.toString(),\n                name: name,\n                symbol: symbol,\n                decimals: decimals\n            });\n        });\n    }, []);\n\n    const transferTokens = async (recipient, amount) => {\n        try {\n            const decimals = await props.web3.contract.decimals();\n            await props.web3.contract.transfer(recipient, parseAmount(amount, decimals));\n        } catch (e) { \n            console.error(e);\n            alert('Error: Transfer failed.');\n        }\n    }\n\n    const setTokenAllowance = async (recipient, amount) => {\n        try {\n            const sender = await props.web3.signer.getAddress();\n            const balance = await props.web3.contract.balanceOf(sender);\n            const decimals = await props.web3.contract.decimals();\n            if (balance >= formatBalance(amount, decimals)) {\n                await props.web3.contract.approve(recipient, parseAmount(amount, decimals));\n            }\n            else alert(\"Error: Insufficient balance.\")\n        } catch (e) { \n            console.error(e);\n            alert('Error: Allowance failed.');\n        }\n    }\n\n    const transferAllowance = async (owner, recipient, amount) => {\n        try {\n            const balance = await props.web3.contract.balanceOf(owner);\n            const decimals = await props.web3.contract.decimals();\n            if (balance >= formatBalance(amount, decimals) ) {\n                await props.web3.contract.transferFrom(owner, recipient, parseAmount(amount, decimals));\n            }\n        } catch (e) { \n            console.error(e);\n            alert('Error: Transfer failed.');\n        }\n    }\n\n    const formatBalance = (balance, dec) => {\n        if (dec === 0) return balance;\n        let bal = balance;\n        while (bal.length <= dec) bal = '0'+bal;\n        bal = bal.slice(0,0-dec)+'.'+bal.slice(0-dec);\n        while (bal[bal.length-1] === '0') bal = bal.slice(0,-1);\n        if (bal[bal.length-1] === '.') bal = bal.slice(0,-1);\n        return bal;\n    }\n\n    const parseAmount = (amt, dec) => {\n        let amount = amt;\n        if (amount.indexOf('.') < 0) {\n            for (let i=0; i<dec; i++) {\n                amount=amount+'0';\n            }\n            return amount;\n        }\n        while (amount.length-amount.indexOf('.') <= dec) amount=amount+'0';\n        if (amount.length-amount.indexOf('.') > dec+1) amount = amount.slice(0,amount.indexOf('.')+dec);\n        return amount.slice(0,amount.indexOf('.'))+amount.slice(amount.indexOf('.')+1);\n    }\n\n    return (\n        <Form>\n            <h3>Token Dashboard</h3>\n            <div className=\"form-row\"><label>Token Address: {props.tokenAddress}</label></div>\n            <div className=\"form-row\"><label>Token Name: {props.tokenData.name}</label></div>\n            <div className=\"form-row\"><label>Token Symbol: {props.tokenData.symbol}</label></div>\n            <div className=\"form-row\"><label>Account Address: {props.tokenData.accountAddress}</label></div>\n            <div className=\"form-row\"><label>Token Balance: {formatBalance(props.tokenData.balance.toString(), props.tokenData.decimals)} {props.tokenData.symbol}</label></div>\n            <hr/>\n            <h3>Transfer Tokens</h3>\n            <div className=\"form-row\">\n                <label>Recipient</label>\n                <input className=\"text-input\" value={transferRecipient} onChange={(event)=>setTransferRecipient(event.target.value)}/><br/>\n                <label>Amount</label>\n                <input type=\"number\" value={transferAmount} onChange={(event)=>setTransferAmount(event.target.value)}/>\n                <Button size=\"sm\" variant=\"danger\" onClick={() => transferTokens(transferRecipient, transferAmount)}>Transfer</Button>\n            </div>\n            <hr/>\n            <h3>Set Token Allowance</h3>\n            <div className=\"form-row\">\n                <label>Spender</label>\n                <input className=\"text-input\" value={allowanceSpender} onChange={(event)=>setAllowanceSpender(event.target.value)}/><br/>\n                <label>Amount</label>\n                <input type=\"number\" value={allowanceAmount} onChange={(event)=>setAllowanceAmount(event.target.value)}/>\n                <Button size=\"sm\" variant=\"danger\" onClick={() => setTokenAllowance(allowanceSpender, allowanceAmount)}>Set Allowance</Button>\n            </div>\n            <hr/>\n            <h3>Claim Allowance</h3>\n            <div className=\"form-row\">\n                <label>Owner</label>\n                <input className=\"text-input\" value={claimOwner} onChange={(event)=>setClaimOwner(event.target.value)}/><br/>\n                {validAllowance && <div><label>Available Allowance: {allowanceAvailable} {props.tokenData.symbol}</label><br/></div>}\n                <label>Amount</label>\n                <input type=\"number\" value={claimAmount} onChange={(event)=>setClaimAmount(event.target.value)}/>\n                <Button size=\"sm\" variant=\"danger\" onClick={() => transferAllowance(claimOwner, (sendAllowance ? sendAddress : props.tokenData.accountAddress), claimAmount)}>{sendAllowance ? \"Send Allowance\" : \"Claim Allowance\"}</Button>\n                {/*<label><input type=\"checkbox\" checked={sendAllowance} onChange={()=>setSendAllowance(!sendAllowance)}/> Send to another address</label>*/}\n                {/*sendAllowance &&\n                    <div>\n                        <label>Destination address</label>\n                        <input className=\"text-input\" value={sendAddress} onChange={(event)=>setSendAddress(event.target.value)}/>\n                    </div>*/}\n            </div>\n            <div className=\"form-row btn-row\">\n                <Link to=\"/token-builder/dashboard\">\n                    <Button variant=\"secondary\" onClick={props.reset}>Use a Different Token</Button>\n                </Link>\n            </div>\n        </Form>\n    )\n}\nexport default Dashboard;"]},"metadata":{},"sourceType":"module"}